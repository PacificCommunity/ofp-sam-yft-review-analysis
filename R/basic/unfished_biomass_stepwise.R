library(FLR4MFCL)
library(TAF)

# xyplot(data~year|area, group=qname,
#        data=FLQuants(qts(adultBiomass_nofish(rep20)), qts(adultBiomass_nofish(rep17)), qts(adultBiomass_nofish(rep14))),
#        type="l", as.table=TRUE, main="Unfished biomass")
# 
# xyplot(data~year|area, group=qname,
#        data=FLQuants(qts(adultBiomass(rep20)), qts(adultBiomass(rep17)), qts(adultBiomass(rep14))),
#        type="l", as.table=TRUE, main="Fished biomass")

# rep07 <- read.MFCLRep("d:/x/temp2/BaseYFT/plot.final.rep")
# rep09 <- read.MFCLRep("d:/x/temp2/YFTBase09/final-final.rep")
# rep11 <- read.MFCLRep("d:/x/temp2/2011_YFT_basecase/plot-final.par.rep")

rep09 <- read.MFCLRep("z:/yft/2020_review/analysis/historical_assessments/yft2009/YFTBase09/final-final.rep")
rep11 <- read.MFCLRep("z:/yft/2020_review/analysis/historical_assessments/yft2011/2011_YFT_basecase/plot-final.par.rep")
rep14 <- read.MFCLRep("z:/yft/2014/assessment/RefCase/plot-12.par.rep")
rep17 <- read.MFCLRep("z:/yft/2017/assessment/Model_Runs/For_Web/plot-14.par.rep")
rep20 <- read.MFCLRep("z:/yft/2020/assessment/ModelRuns/Diagnostic/plot-14.par.rep")

rep09 <- read.MFCLRep("z:/yft/2020_review/analysis/stepwise/09_IdxNoeff/plot-14.par.rep")
rep10 <- read.MFCLRep("z:/yft/2020_review/analysis/stepwise/10_SelUngroup/plot-12.par.rep")
rep11 <- read.MFCLRep("z:/yft/2020_review/analysis/stepwise/11_JPTP/plot-14.par.rep")
rep12 <- read.MFCLRep("z:/yft/2020_review/analysis/stepwise/12_Age10LW/plot-14.par.rep")
rep13 <- read.MFCLRep("z:/yft/2020_review/analysis/stepwise/13_CondAge/plot-11.par.rep")
rep14 <- read.MFCLRep("z:/yft/2020_review/analysis/stepwise/14_MatLength/plot-11.par.rep")
rep15 <- read.MFCLRep("z:/yft/2020_review/analysis/stepwise/15_NoSpnFrac/plot-11.par.rep")
rep16 <- read.MFCLRep("z:/yft/2020_review/analysis/stepwise/16_Size60/plot-10.par.rep")
rep17 <- read.MFCLRep("z:/yft/2020_review/analysis/stepwise/17_Diag20/plot-14.par.rep")
rep18 <- read.MFCLRep("z:/yft/2020_review/analysis/stepwise/18_Diag20_CC/plot-11.par.rep")

# Biomass
B.09 <- flr2taf(SB(rep09), "B")
B.10 <- flr2taf(SB(rep10), "B")
B.11 <- flr2taf(SB(rep11), "B")
B.12 <- flr2taf(SB(rep12), "B")
B.13 <- flr2taf(SB(rep13), "B")
B.14 <- flr2taf(SB(rep14), "B")
B.15 <- flr2taf(SB(rep15), "B")
B.16 <- flr2taf(SB(rep16), "B")
B.17 <- flr2taf(SB(rep17), "B")
B.18 <- flr2taf(SB(rep18), "B")

plot(NA, xlim=c(1950,2020), ylim=c(0,9), yaxs="i", xlab="Year", ylab="SB (million t)", main = "Spawning Biomass")
legend("topright", c("09_IdxNoeff", "10_SelUngroup", "11_JPTP", "12_Age10LW", "13_CondAge", 
                     "14_MatLength", "15_NoSpnFrac", "16_Size60", "17_Diag20", "18_Diag20_CC"), 
       col = c(9,8,7,6,5,4,3,2,1,10), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,9,by=1), col="gray", lwd=0.5)
lines(div(B.09, 2, 1e6), lwd=1, col=9)
lines(div(B.10, 2, 1e6), lwd=2, col=8)
lines(div(B.11, 2, 1e6), lwd=2, col=7)
lines(div(B.12, 2, 1e6), lwd=2, col=6)
lines(div(B.13, 2, 1e6), lwd=2, col=5)
lines(div(B.14, 2, 1e6), lwd=2, col=4)
lines(div(B.15, 2, 1e6), lwd=2, col=3)
lines(div(B.16, 2, 1e6), lwd=2, col=2)
lines(div(B.17, 2, 1e6), lwd=2, col=1)
lines(div(B.18, 2, 1e6), lwd=1, col=10)
box() 

# Dynamic B0
B0.09 <- flr2taf(SBF0(rep09), "B0")
B0.10 <- flr2taf(SBF0(rep10), "B0")
B0.11 <- flr2taf(SBF0(rep11), "B0")
B0.12 <- flr2taf(SBF0(rep12), "B0")
B0.13 <- flr2taf(SBF0(rep13), "B0")
B0.14 <- flr2taf(SBF0(rep14), "B0")
B0.15 <- flr2taf(SBF0(rep15), "B0")
B0.16 <- flr2taf(SBF0(rep16), "B0")
B0.17 <- flr2taf(SBF0(rep17), "B0")
B0.18 <- flr2taf(SBF0(rep18), "B0")

plot(NA, xlim=c(1950,2020), ylim=c(0,9), yaxs="i", xlab="Year", ylab="SBF=0 (million t)", main = "Unfished Biomass")
legend("topright", c("09_IdxNoeff", "10_SelUngroup", "11_JPTP", "12_Age10LW", "13_CondAge", 
                       "14_MatLength", "15_NoSpnFrac", "16_Size60", "17_Diag20", "18_Diag20_CC"), 
       col = c(9,8,7,6,5,4,3,2,1,10), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,9,by=1), col="gray", lwd=0.5)
lines(div(B0.09, 2, 1e6), lwd=1, col=9)
lines(div(B0.10, 2, 1e6), lwd=2, col=8)
lines(div(B0.11, 2, 1e6), lwd=2, col=7)
lines(div(B0.12, 2, 1e6), lwd=2, col=6)
lines(div(B0.13, 2, 1e6), lwd=2, col=5)
lines(div(B0.14, 2, 1e6), lwd=2, col=4)
lines(div(B0.15, 2, 1e6), lwd=2, col=3)
lines(div(B0.16, 2, 1e6), lwd=2, col=2)
lines(div(B0.17, 2, 1e6), lwd=2, col=1)
lines(div(B0.18, 2, 1e6), lwd=1, col=10)
box()

# Depletion (instantaneous)
Dep.09 <- data.frame(Year=B.09$Year, Dep=B.09$B/B0.09$B0)
Dep.10 <- data.frame(Year=B.10$Year, Dep=B.10$B/B0.10$B0)
Dep.11 <- data.frame(Year=B.11$Year, Dep=B.11$B/B0.11$B0)
Dep.12 <- data.frame(Year=B.12$Year, Dep=B.12$B/B0.12$B0)
Dep.13 <- data.frame(Year=B.13$Year, Dep=B.13$B/B0.13$B0)
Dep.14 <- data.frame(Year=B.14$Year, Dep=B.14$B/B0.14$B0)
Dep.15 <- data.frame(Year=B.15$Year, Dep=B.15$B/B0.15$B0)
Dep.16 <- data.frame(Year=B.16$Year, Dep=B.16$B/B0.16$B0)
Dep.17 <- data.frame(Year=B.17$Year, Dep=B.17$B/B0.17$B0)
Dep.18 <- data.frame(Year=B.18$Year, Dep=B.18$B/B0.18$B0)

plot(NA, xlim=c(1950,2020), ylim=c(0,1), yaxs="i", xlab="Year", ylab="SB / SBF=0", main = "Depletion")
legend("bottomleft", c("09_IdxNoeff", "10_SelUngroup", "11_JPTP", "12_Age10LW", "13_CondAge", 
                     "14_MatLength", "15_NoSpnFrac", "16_Size60", "17_Diag20", "18_Diag20_CC"), 
       col = c(9,8,7,6,5,4,3,2,1,10), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,1,by=0.1), col="gray", lwd=0.5)
lines(Dep.09, lwd=1, col=9)
lines(Dep.10, lwd=2, col=8)
lines(Dep.11, lwd=2, col=7)
lines(Dep.12, lwd=2, col=6)
lines(Dep.13, lwd=2, col=5)
lines(Dep.14, lwd=2, col=4)
lines(Dep.15, lwd=2, col=3)
lines(Dep.16, lwd=2, col=2)
lines(Dep.17, lwd=2, col=1)
lines(Dep.18, lwd=2, col=10)
box()

# Scaled Biomass
ScaledB.09 <- data.frame(Year=B.09$Year, ScaledB=B.09$B/B.09$B[1])
ScaledB.10 <- data.frame(Year=B.10$Year, ScaledB=B.10$B/B.10$B[1])
ScaledB.11 <- data.frame(Year=B.11$Year, ScaledB=B.11$B/B.11$B[1])
ScaledB.12 <- data.frame(Year=B.12$Year, ScaledB=B.12$B/B.12$B[1])
ScaledB.13 <- data.frame(Year=B.13$Year, ScaledB=B.13$B/B.13$B[1])
ScaledB.14 <- data.frame(Year=B.14$Year, ScaledB=B.14$B/B.14$B[1])
ScaledB.15 <- data.frame(Year=B.15$Year, ScaledB=B.15$B/B.15$B[1])
ScaledB.16 <- data.frame(Year=B.16$Year, ScaledB=B.16$B/B.16$B[1])
ScaledB.17 <- data.frame(Year=B.17$Year, ScaledB=B.17$B/B.17$B[1])
ScaledB.18 <- data.frame(Year=B.18$Year, ScaledB=B.18$B/B.18$B[1])

plot(NA, xlim=c(1950,2020), ylim=c(0,1.1), yaxs="i", xlab="Year", ylab="Scaled SB", main = "Relative Spawning Biomass")
legend("topright", c("09_IdxNoeff", "10_SelUngroup", "11_JPTP", "12_Age10LW", "13_CondAge", 
                       "14_MatLength", "15_NoSpnFrac", "16_Size60", "17_Diag20", "18_Diag20_CC"), 
       col = c(9,8,7,6,5,4,3,2,1,10), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,1.1,by=0.1), col="gray", lwd=0.5)
lines(ScaledB.09, lwd=1, col=9)
lines(ScaledB.10, lwd=2, col=8)
lines(ScaledB.11, lwd=2, col=7)
lines(ScaledB.12, lwd=2, col=6)
lines(ScaledB.13, lwd=2, col=5)
lines(ScaledB.14, lwd=2, col=4)
lines(ScaledB.15, lwd=2, col=3)
lines(ScaledB.16, lwd=2, col=2)
lines(ScaledB.17, lwd=2, col=1)
lines(ScaledB.18, lwd=1, col=10)
box()

# Scaled B0
ScaledB0.09 <- data.frame(Year=B0.09$Year, ScaledB0=B0.09$B0/B0.09$B0[1])
ScaledB0.10 <- data.frame(Year=B0.10$Year, ScaledB0=B0.10$B0/B0.10$B0[1])
ScaledB0.11 <- data.frame(Year=B0.11$Year, ScaledB0=B0.11$B0/B0.11$B0[1])
ScaledB0.12 <- data.frame(Year=B0.12$Year, ScaledB0=B0.12$B0/B0.12$B0[1])
ScaledB0.13 <- data.frame(Year=B0.13$Year, ScaledB0=B0.13$B0/B0.13$B0[1])
ScaledB0.14 <- data.frame(Year=B0.14$Year, ScaledB0=B0.14$B0/B0.14$B0[1])
ScaledB0.15 <- data.frame(Year=B0.15$Year, ScaledB0=B0.15$B0/B0.15$B0[1])
ScaledB0.16 <- data.frame(Year=B0.16$Year, ScaledB0=B0.16$B0/B0.16$B0[1])
ScaledB0.17 <- data.frame(Year=B0.17$Year, ScaledB0=B0.17$B0/B0.17$B0[1])
ScaledB0.18 <- data.frame(Year=B0.18$Year, ScaledB0=B0.18$B0/B0.18$B0[1])


plot(NA, xlim=c(1950,2020), ylim=c(0,1.4), yaxs="i", xlab="Year", ylab="Scaled SBF=0", main = "Relative Unfished Biomass")
legend("topright", c("09_IdxNoeff", "10_SelUngroup", "11_JPTP", "12_Age10LW", "13_CondAge", 
                       "14_MatLength", "15_NoSpnFrac", "16_Size60", "17_Diag20", "18_Diag20_CC"), 
       col = c(9,8,7,6,5,4,3,2,1,10), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,1.4,by=0.1), col="gray", lwd=0.5)
lines(ScaledB0.09, lwd=1, col=9)
lines(ScaledB0.10, lwd=2, col=8)
lines(ScaledB0.11, lwd=2, col=7)
lines(ScaledB0.12, lwd=2, col=6)
lines(ScaledB0.13, lwd=2, col=5)
lines(ScaledB0.14, lwd=2, col=4)
lines(ScaledB0.15, lwd=2, col=3)
lines(ScaledB0.16, lwd=2, col=2)
lines(ScaledB0.17, lwd=2, col=1)
lines(ScaledB0.18, lwd=1, col=10)
box()


# Biomass recent (averaged over the last 4 years)
Br.09 <- flr2taf(SBrecent(rep09), "Br")
Br.10 <- flr2taf(SBrecent(rep10), "Br")
Br.11 <- flr2taf(SBrecent(rep11), "Br")
Br.12 <- flr2taf(SBrecent(rep12), "Br")
Br.13 <- flr2taf(SBrecent(rep13), "Br")
Br.14 <- flr2taf(SBrecent(rep14), "Br")
Br.15 <- flr2taf(SBrecent(rep15), "Br")
Br.16 <- flr2taf(SBrecent(rep16), "Br")
Br.17 <- flr2taf(SBrecent(rep17), "Br")
Br.18 <- flr2taf(SBrecent(rep18), "Br")

plot(NA, xlim=c(1950,2020), ylim=c(0,9), yaxs="i", xlab="Year", ylab="SB (million t)", main = "Spawning Biomass (recent)")
legend("topright", c("09_IdxNoeff", "10_SelUngroup", "11_JPTP", "12_Age10LW", "13_CondAge", 
                     "14_MatLength", "15_NoSpnFrac", "16_Size60", "17_Diag20", "18_Diag20_CC"), 
       col = c(9,8,7,6,5,4,3,2,1,10), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,9,by=1), col="gray", lwd=0.5)
lines(div(Br.09, 2, 1e6), lwd=1, col=9)
lines(div(Br.10, 2, 1e6), lwd=2, col=8)
lines(div(Br.11, 2, 1e6), lwd=2, col=7)
lines(div(Br.12, 2, 1e6), lwd=2, col=6)
lines(div(Br.13, 2, 1e6), lwd=2, col=5)
lines(div(Br.14, 2, 1e6), lwd=2, col=4)
lines(div(Br.15, 2, 1e6), lwd=2, col=3)
lines(div(Br.16, 2, 1e6), lwd=2, col=2)
lines(div(Br.17, 2, 1e6), lwd=2, col=1)
lines(div(Br.18, 2, 1e6), lwd=1, col=10)
box()

# Dynamic B0 (averaged over 10 of the last 11 years)
B0r.09 <- flr2taf(SBF0recent(rep09), "B0r")
B0r.10 <- flr2taf(SBF0recent(rep10), "B0r")
B0r.11 <- flr2taf(SBF0recent(rep11), "B0r")
B0r.12 <- flr2taf(SBF0recent(rep12), "B0r")
B0r.13 <- flr2taf(SBF0recent(rep13), "B0r")
B0r.14 <- flr2taf(SBF0recent(rep14), "B0r")
B0r.15 <- flr2taf(SBF0recent(rep15), "B0r")
B0r.16 <- flr2taf(SBF0recent(rep16), "B0r")
B0r.17 <- flr2taf(SBF0recent(rep17), "B0r")
B0r.18 <- flr2taf(SBF0recent(rep18), "B0r")

plot(NA, xlim=c(1950,2020), ylim=c(0,9), yaxs="i", xlab="Year", ylab="SBF=0 (million t)", main = "Unfished Biomass (10 years)")
legend("topright", c("09_IdxNoeff", "10_SelUngroup", "11_JPTP", "12_Age10LW", "13_CondAge", 
                     "14_MatLength", "15_NoSpnFrac", "16_Size60", "17_Diag20", "18_Diag20_CC"), 
       col = c(9,8,7,6,5,4,3,2,1,10), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,9,by=1), col="gray", lwd=0.5)
lines(div(B0r.09, 2, 1e6), lwd=1, col=9)
lines(div(B0r.10, 2, 1e6), lwd=2, col=8)
lines(div(B0r.11, 2, 1e6), lwd=2, col=7)
lines(div(B0r.12, 2, 1e6), lwd=2, col=6)
lines(div(B0r.13, 2, 1e6), lwd=2, col=5)
lines(div(B0r.14, 2, 1e6), lwd=2, col=4)
lines(div(B0r.15, 2, 1e6), lwd=2, col=3)
lines(div(B0r.16, 2, 1e6), lwd=2, col=2)
lines(div(B0r.17, 2, 1e6), lwd=2, col=1)
lines(div(B0r.18, 2, 1e6), lwd=1, col=10)
box()


# Depletion (as used by management - not instantaneous)
Depr.09 <- data.frame(Year=Br.09$Year, Dep=Br.09$Br/B0r.09$B0r)
Depr.10 <- data.frame(Year=Br.10$Year, Dep=Br.10$Br/B0r.10$B0r)
Depr.11 <- data.frame(Year=Br.11$Year, Dep=Br.11$Br/B0r.11$B0r)
Depr.12 <- data.frame(Year=Br.12$Year, Dep=Br.12$Br/B0r.12$B0r)
Depr.13 <- data.frame(Year=Br.13$Year, Dep=Br.13$Br/B0r.13$B0r)
Depr.14 <- data.frame(Year=Br.14$Year, Dep=Br.14$Br/B0r.14$B0r)
Depr.15 <- data.frame(Year=Br.15$Year, Dep=Br.15$Br/B0r.15$B0r)
Depr.16 <- data.frame(Year=Br.16$Year, Dep=Br.16$Br/B0r.16$B0r)
Depr.17 <- data.frame(Year=Br.17$Year, Dep=Br.17$Br/B0r.17$B0r)
Depr.18 <- data.frame(Year=Br.18$Year, Dep=Br.18$Br/B0r.18$B0r)

plot(NA, xlim=c(1950,2020), ylim=c(0,1), yaxs="i", xlab="Year", ylab="SB / SBF=0", main = "Depletion (averaged)")
legend("bottomleft", c("09_IdxNoeff", "10_SelUngroup", "11_JPTP", "12_Age10LW", "13_CondAge", 
                       "14_MatLength", "15_NoSpnFrac", "16_Size60", "17_Diag20", "18_Diag20_CC"), 
       col = c(9,8,7,6,5,4,3,2,1,10), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,1,by=0.1), col="gray", lwd=0.5)
lines(Depr.09, lwd=1, col=9)
lines(Depr.10, lwd=2, col=8)
lines(Depr.11, lwd=2, col=7)
lines(Depr.12, lwd=2, col=6)
lines(Depr.13, lwd=2, col=5)
lines(Depr.14, lwd=2, col=4)
lines(Depr.15, lwd=2, col=3)
lines(Depr.16, lwd=2, col=2)
lines(Depr.17, lwd=2, col=1)
lines(Depr.18, lwd=2, col=10)
box()


# Scaled Biomass (averaged over the last 4 years - by hand)
ScaledBr.09 <- data.frame(Year=Br.09$Year, ScaledB=Br.09$Br/Br.09$Br[4])
ScaledBr.10 <- data.frame(Year=Br.10$Year, ScaledB=Br.10$Br/Br.10$Br[4])
ScaledBr.11 <- data.frame(Year=Br.11$Year, ScaledB=Br.11$Br/Br.11$Br[4])
ScaledBr.12 <- data.frame(Year=Br.12$Year, ScaledB=Br.12$Br/Br.12$Br[4])
ScaledBr.13 <- data.frame(Year=Br.13$Year, ScaledB=Br.13$Br/Br.13$Br[4])
ScaledBr.14 <- data.frame(Year=Br.14$Year, ScaledB=Br.14$Br/Br.14$Br[4])
ScaledBr.15 <- data.frame(Year=Br.15$Year, ScaledB=Br.15$Br/Br.15$Br[4])
ScaledBr.16 <- data.frame(Year=Br.16$Year, ScaledB=Br.16$Br/Br.16$Br[4])
ScaledBr.17 <- data.frame(Year=Br.17$Year, ScaledB=Br.17$Br/Br.17$Br[4])
ScaledBr.18 <- data.frame(Year=Br.18$Year, ScaledB=Br.18$Br/Br.18$Br[4])

plot(NA, xlim=c(1950,2020), ylim=c(0,1.1), yaxs="i", xlab="Year", ylab="Scaled SB", main = "Relative Spawning Biomass (recent)")
legend("topright", c("09_IdxNoeff", "10_SelUngroup", "11_JPTP", "12_Age10LW", "13_CondAge", 
                     "14_MatLength", "15_NoSpnFrac", "16_Size60", "17_Diag20", "18_Diag20_CC"), 
       col = c(9,8,7,6,5,4,3,2,1,10), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,1.1,by=0.1), col="gray", lwd=0.5)
lines(ScaledBr.09, lwd=1, col=9)
lines(ScaledBr.10, lwd=2, col=8)
lines(ScaledBr.11, lwd=2, col=7)
lines(ScaledBr.12, lwd=2, col=6)
lines(ScaledBr.13, lwd=2, col=5)
lines(ScaledBr.14, lwd=2, col=4)
lines(ScaledBr.15, lwd=2, col=3)
lines(ScaledBr.16, lwd=2, col=2)
lines(ScaledBr.17, lwd=2, col=1)
lines(ScaledBr.18, lwd=1, col=10)
box()


# Scaled B0 (averaged over 10 of the last 11 years - by hand)
ScaledB0r.09 <- data.frame(Year=B0r.09$Year, ScaledB0r=B0r.09$B0r/B0r.09$B0r[11])
ScaledB0r.10 <- data.frame(Year=B0r.10$Year, ScaledB0r=B0r.10$B0r/B0r.10$B0r[11])
ScaledB0r.11 <- data.frame(Year=B0r.11$Year, ScaledB0r=B0r.11$B0r/B0r.11$B0r[11])
ScaledB0r.12 <- data.frame(Year=B0r.12$Year, ScaledB0r=B0r.12$B0r/B0r.12$B0r[11])
ScaledB0r.13 <- data.frame(Year=B0r.13$Year, ScaledB0r=B0r.13$B0r/B0r.13$B0r[11])
ScaledB0r.14 <- data.frame(Year=B0r.14$Year, ScaledB0r=B0r.14$B0r/B0r.14$B0r[11])
ScaledB0r.15 <- data.frame(Year=B0r.15$Year, ScaledB0r=B0r.15$B0r/B0r.15$B0r[11])
ScaledB0r.16 <- data.frame(Year=B0r.16$Year, ScaledB0r=B0r.16$B0r/B0r.16$B0r[11])
ScaledB0r.17 <- data.frame(Year=B0r.17$Year, ScaledB0r=B0r.17$B0r/B0r.17$B0r[11])
ScaledB0r.18 <- data.frame(Year=B0r.18$Year, ScaledB0r=B0r.18$B0r/B0r.18$B0r[11])


plot(NA, xlim=c(1950,2020), ylim=c(0,1.1), yaxs="i", xlab="Year", ylab="Scaled SBF=0", main = "Relative Unfished Biomass (10 years)")
legend("topright", c("09_IdxNoeff", "10_SelUngroup", "11_JPTP", "12_Age10LW", "13_CondAge", 
                     "14_MatLength", "15_NoSpnFrac", "16_Size60", "17_Diag20", "18_Diag20_CC"), 
       col = c(9,8,7,6,5,4,3,2,1,10), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,1.1,by=0.1), col="gray", lwd=0.5)
lines(ScaledB0r.09, lwd=1, col=9)
lines(ScaledB0r.10, lwd=2, col=8)
lines(ScaledB0r.11, lwd=2, col=7)
lines(ScaledB0r.12, lwd=2, col=6)
lines(ScaledB0r.13, lwd=2, col=5)
lines(ScaledB0r.14, lwd=2, col=4)
lines(ScaledB0r.15, lwd=2, col=3)
lines(ScaledB0r.16, lwd=2, col=2)
lines(ScaledB0r.17, lwd=2, col=1)
lines(ScaledB0r.18, lwd=1, col=10)
box()


########################################################################################################
## Should have used this code!! Whoops...

# FLR4MFCL depletion (instantaneous)
SBSBF0.09 <- flr2taf(SBSBF0(rep09), "B")
SBSBF0.11 <- flr2taf(SBSBF0(rep11), "B")
SBSBF0.14 <- flr2taf(SBSBF0(rep14), "B")
SBSBF0.17 <- flr2taf(SBSBF0(rep17), "B")
SBSBF0.20 <- flr2taf(SBSBF0(rep20), "B")

plot(NA, xlim=c(1950,2020), ylim=c(0,1.0), yaxs="i", xlab="Year", ylab="SB / SBF=0", main = "FLR4MFCL Depletion (instantaneous)")
legend("topright", c("2009", "2011", "2014", "2017", "2020"), col = c(5,4,3,2,1), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,1.4,by=0.1), col="gray", lwd=0.5)
lines(SBSBF0.09, lwd=2, col=5)
lines(SBSBF0.11, lwd=2, col=4)
lines(SBSBF0.14, lwd=2, col=3)
lines(SBSBF0.17, lwd=2, col=2)
lines(SBSBF0.20, lwd=2, col=1)
box()


# FLR4MFCL depletion (averaged )
SBSBF0r.09 <- flr2taf(SBSBF0recent(rep09), "B")
SBSBF0r.11 <- flr2taf(SBSBF0recent(rep11), "B")
SBSBF0r.14 <- flr2taf(SBSBF0recent(rep14), "B")
SBSBF0r.17 <- flr2taf(SBSBF0recent(rep17), "B")
SBSBF0r.20 <- flr2taf(SBSBF0recent(rep20), "B")

plot(NA, xlim=c(1950,2020), ylim=c(0,1.0), yaxs="i", xlab="Year", ylab="SB / SBF=0", main = "FLR4MFCL Depletion (averaged)")
legend("topright", c("2009", "2011", "2014", "2017", "2020"), col = c(5,4,3,2,1), lty = 1, lwd = 2, box.lty = 0, inset= 0.01)
abline(h=seq(0,1.4,by=0.1), col="gray", lwd=0.5)
lines(SBSBF0r.09, lwd=2, col=5)
lines(SBSBF0r.11, lwd=2, col=4)
lines(SBSBF0r.14, lwd=2, col=3)
lines(SBSBF0r.17, lwd=2, col=2)
lines(SBSBF0r.20, lwd=2, col=1)
box()
